{% extends "base.html" %}
{% block title %}PRODUCTS | WASTED{% endblock %}

{% block content %}
<nav class="category-bar">
    {% for c in categories %}
    <a href="{{ url_for('shop_list', category=c) }}" class="category {% if c == current_category %}active{% endif %}">
        {{ c }}
    </a>
    {% endfor %}
</nav>

<section class="grid">
    {% for p in products %}
    <article class="card">
        <a href="{{ url_for('product_detail', product_id=p.id) }}">
            <div class="thumb-wrap">
                <img src="{{ url_for('product_image', product_id=p.id) }}" alt="{{ p.name }}">
            </div>
        </a>

        <a href="{{ url_for('product_detail', product_id=p.id) }}">
            <div class="name">{{ p.name }}</div>
        </a>

        {# ✅ p.is_soldout 대신: DB에서 내려온 total_stock으로 판단 #}
        {% if (p.total_stock | int) <= 0 %} <div class="status out">OUT OF STOCK</div>
            {% else %}
            <div class="price">KRW {{ "{:,}".format(p.price) }}</div>
            {% endif %}
    </article>
    {% endfor %}
</section>
{% endblock %}